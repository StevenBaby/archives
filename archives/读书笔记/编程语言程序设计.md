# 编程语言程序设计

[annotation]: [id] (d8df2fd4-57a7-4b7c-9e19-75b2c0d2c8f2)
[annotation]: [status] (public)
[annotation]: [create_time] (2021-04-28 11:37:52)
[annotation]: [category] (计算机技术)
[annotation]: [tags] (汇编语言)
[annotation]: [comments] (false)
[annotation]: [url] (http://blog.ccyg.studio/article/d8df2fd4-57a7-4b7c-9e19-75b2c0d2c8f2)

## 什么是汇编语言

### 处理器指令

IA-32 指令码格式由四部分组成：

- 可选指令前缀
- 指令码
- 可选指令修改器
- 可选数据元素

![assembly-01.jpg](images/assembly-01.jpg)

#### 指令码

指令码是指令格式中必须提供的，指示处理器应该执行什么功能或者任务。

指令码的长度为 1 ~ 3 字节不等，例如 `OF A2` 表示了 `cupid` 指令，执行该指令时，处理器会把当前微处理器的信息存储到不同的寄存器。

#### 指令前缀

指令前缀可以包含 1 ~ 4 个字节的信息，来修改指令码的行为。指令前缀可分为四类：

- 锁前缀和重复前缀
- 段重写前缀和分支提示前缀
- 操作数大小前缀
- 地址大小前缀

每一类在前缀中只能只能用一次来修改指令码，或者说描述指令码。

锁前缀指示任何共享内存区域将被该指令排他性的使用。这对于多处理器和混合多线程系统特别重要。

重复前缀用于指示重复的功能，通常用于操作字符串。

段重写前缀指示指令可以重写预定义的段寄存器。

分支提示前缀尝试给处理器一些线索，用于指示条件转义指令的时候，最可能跳转的分支，常用于分支预测硬件。

操作数大小前缀用于提示处理器，当前操作码是 16 位 还是 32 位的。可以帮助处理器使用大操作数，和加速数据赋值到寄存器。

地址大小签注提示处理器使用的是那种大小的内存地址，每种大小都可以被设置为程序的默认大小，前缀可用于临时修改该大小。

#### 修改器

一些指令码需要额外的修改器来定义什么寄存器或者内存地址参与其中。修改器包含三个不同的值。

- 地址格式指示字节
- SIB 字节
- 1,2 或 4 个地址位移字节

### 汇编语言

汇编语言程序由三部分来定义程序的操作：

- 操作码助记符
- 数据段
- 汇编指令

#### 操作码助记符

例如：指令码的样例：

```
55
89 E5
83 EC 08
C7 45 FC 01 00 00 00
83 EC 0C
6A 00
E8 D1 FE FF FF
```

可以重写成为：

```s
push %ebp
mov %esp, %ebp
sub $0x8, %esp
movl $0x1, -4(%ebp)
sub $0xc, %esp
push $0x0
call 8048348
```



## 参考资料

- [Professional Assembly Language](https://book.douban.com/subject/2039913/)
