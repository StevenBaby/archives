# 冒泡排序

[annotation]: <id> (abf13747-d9c0-44c9-91b4-e0a207b15aa6)
[annotation]: <status> (public)
[annotation]: <create_time> (2019-04-22 16:20:56)
[annotation]: <category> (计算机科学)
[annotation]: <tags> (数据结构)

> 原文链接：<http://blog.ccyg.studio/article/abf13747-d9c0-44c9-91b4-e0a207b15aa6>

---
下面，做一些有趣的事情，下面的动画演示了冒泡排序的过程。

<div class="ui segments">
    <div class="ui segment" id="sketch-holder"></div>
    <div class='ui segment'>
        <button class='ui primary reset button'>重置</button>
        <button class='ui red stop button'>停止</button>
        <button class='ui teal speed down button'>减速</button>
        <button class='ui pink speed up button'>加速</button>
    </div>
</div>

<div>
    <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@0.8.0/lib/p5.min.js"></script>
</div>

<script>
var count = 32;
var array = new Array();
var left = null;
var right = null;
var times = 0;
var exchange = 0;
var delay = 500;

function sleep(ms){
  return new Promise((resolve)=>setTimeout(resolve,ms));
}

async function start(){
    var current_times = times;
    for (let i = 0; i < array.length; i++) {
        for (let j = 1; j < array.length - i; j++) {
            left = j - 1;
            right = j;
            if( array[j] < array[j - 1])
            {
                exchange = 1;
                await sleep(delay);
                let temp = array[j];
                array[j] = array[j - 1];
                array[j - 1] = temp;

                exchange = 2;
                await sleep(delay);
                console.log('take a exchange');
            }
            exchange = 0;
            await sleep(delay);
            if(current_times != times){
                return;
            }
        }
    }
    left = null;
    right = null;
}

function reset(){
    left = null;
    right = null;
    delay = 500;
    times += 1;
    for (let index = 0; index < count; index++) {
        array[index] = parseInt(Math.random() * 100);
    }
    start();
}

function stop(){
    times += 1;
}


function setup() {
    var width = $("#sketch-holder").width();
    canvas = createCanvas(width, width/1.77);
    canvas.parent('sketch-holder');
    reset();
}

function fill_index(index){
    var red = color(219,40,40);
    var blue = color(33,133,208);
    var pink = color(224,57,151);
    var violet = color(100,53,201);
    var grey = color(130,160,185);
    
    var l = (index == left);
    var r = (index == right);

    if (!l && !r){
        fill(grey);
        return;
    }
    else if (exchange == 1){
        fill(pink);
        return;
    }
    else if (exchange == 2){
        fill(violet);
        return;
    }
    else if (l){
        fill(red);
    }
    else if (r){
        fill(blue);
    }
}


function draw() {
    clear();
    var status = $('.status');
    // $('.status').html(parseInt(width) + " " + parseInt(height));

    var size = width / count;
    for (let index = 0; index < array.length; index++) {
        var w = size;
        var h = (array[index]) * height / 100;
        var x = index * size;
        var y = height - h;
        var t = array[index];
        fill_index(index);
        rect(x, y, w, h);
        fill(255);
        text(t, x, y, w, h);  
    }
}

function windowResized() {
    var width = parseInt($("#sketch-holder").width());
    var height = parseInt(width / 1.77);
    resizeCanvas(width, height);
}

$('.reset.button').click(function(){
    reset();
    start();
});

$('.stop.button').click(function(){
    stop();
})

$('.speed.up.button').click(function(){
    delay -= 50;
})

$('.speed.down.button').click(function(){
    delay += 50;
})
</script>